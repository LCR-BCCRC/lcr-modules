#!/usr/bin/env snakemake


##### SETUP #####


import oncopipe as op

SAMPLES = op.load_samples("data/samples.tsv")

##### REFERENCE_FILES WORKFLOW #####


subworkflow reference_files:
    workdir:
        # "/projects/bgrande/reference_files/"
        "/projects/rmorin_scratch/lcr-modules-references-DEV/"
        # "/projects/dscott_prj/CCSRI_1500/shared/ref/lcr-modules-refs/"
    snakefile:
        "../workflows/reference_files/2.3/reference_files.smk"
    configfile:
        "../workflows/reference_files/2.3/config/default.yaml"


##### CONFIGURATION FILES #####


# Load module-specific configuration
configfile: "../modules/star/1.2/config/default.yaml"
# configfile: "../modules/manta/2.2/config/default.yaml"
configfile: "../modules/sequenza/1.2/config/default.yaml"
# configfile: "../modules/strelka/1.0/config/default.yaml"
configfile: "../modules/controlfreec/1.0/config/default.yaml"


# Load project-specific config, which includes the shared 
# configuration and some module-specific config updates
configfile: "config.yaml"


##### CONFIGURATION UPDATES #####


# Use all samples as a default sample list for each module
config["lcr-modules"]["_shared"]["samples"] = SAMPLES

op.enable_set_functions(config)
op.set_samples("_shared", SAMPLES)

##### MODULE SNAKEFILES #####


# Load module-specific snakefiles

# include: "../modules/star/1.2/star.smk"
# include: "../modules/manta/2.2/manta.smk"
# include: "../modules/sequenza/1.2/sequenza.smk"
# include: "../modules/strelka/1.0/strelka.smk"
include: "../modules/controlfreec/1.0/controlfreec.smk"


##### TARGETS ######


rule all:
    input:
        # rules._star_all.input,
        # rules._manta_all.input,
        # rules._sequenza_all.input,
        # rules._strelka_all.input,
        rules._controlfreec_all.input
