#!/usr/bin/env snakemake


##### SETUP #####


import oncopipe as op

SAMPLES = op.load_samples("data/samples.tsv")


##### REFERENCE_FILES WORKFLOW #####


subworkflow reference_files:
    workdir:
        "reference/"
    snakefile:
        "../workflows/reference_files/1.0/reference_files.smk"
    configfile:
        "../workflows/reference_files/1.0/config/default.yaml"


##### CONFIGURATION FILES #####


# Load module-specific configuration
<<<<<<< HEAD
configfile: "../modules/bam2fastq/1.0/config/default.yaml"
configfile: "../modules/utils/2.0/config/default.yaml"
configfile: "../modules/bwa_mem/1.0/config/default.yaml"
configfile: "../modules/star/1.1/config/default.yaml"
=======

configfile: "../modules/star/1.0/config/default.yaml"
>>>>>>> remotes/origin/module/strelka2/1.0
configfile: "../modules/manta/2.1/config/default.yaml"
configfile: "../modules/strelka/1.0/config/default.yaml"


# Load project-specific config, which includes the shared 
# configuration and some module-specific config updates
configfile: "config.yaml"


##### CONFIGURATION UPDATES #####


# Use all samples as a default sample list for each module
config["lcr-modules"]["_shared"]["samples"] = SAMPLES


##### MODULE SNAKEFILES #####


# Load module-specific snakefiles
include: "../modules/bam2fastq/1.0/bam2fastq.smk"
include: "../modules/utils/2.0/utils.smk"
include: "../modules/bwa_mem/1.0/bwa_mem.smk"
include: "../modules/star/1.1/star.smk"
include: "../modules/manta/2.1/manta.smk"
include: "../modules/strelka/1.0/strelka.smk"

##### TARGETS ######


rule all:
    input:
        rules._bam2fastq_all.input,
        rules._bam2fastq_delete_fastq_all.input,
        rules._bwa_mem_all.input,
        rules._star_all.input,
        rules._manta_all.input,
        rules._strelka_all.input,
