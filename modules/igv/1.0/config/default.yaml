lcr-modules:
    
    igv:

        inputs:
            # Available wildcards: {seq_type} {tumour_sample_id} {normal_sample_id} {pair_status} {genome_build}
            maf: "__UPDATE__"

        regions:
            oncodriveclustl:
                grch37: []
                hg38: []
            hotmaps:
                grch37: []
                hg38: []
            bed:
                grch37: []
                hg38: []
            maf:
                grch37: []
                hg38: []
            mutation_id:
                grch37: []
                hg38: []

        estimate_only: False # Stop after MAF filtering step to estimate total number of snapshots
        identify_failed_snaps: False

        options:
            filter_maf:
                oncodriveclustl_options: # These parameters will filter the OncodriveCLUSTL cluster results file.
                    p_value: 0.001 # Maximum p-value of OncodriveCLUSTL clusters
                    score: # Minimum score of OncodriveCLUSTL clusters
                    n_samples: 5 # Desired number of samples in OncodriveCLUSTL clusters

            genome_map: # Map builds between metadata and MAFs
                grch37: ["grch37","hg19","hg19-clc","hg19-reddy","hs37d5"]
                hg38: ["hg38","hg38-nci","hg38-panea","grch38"]

            liftover_regions:
                reference_chain_file:
                    grch37: "genomes/grch37/chains/grch37/hg19ToHg38.over.chain"
                    hg38: "genomes/hg38/chains/grch38/hg38ToHg19.over.chain"
                target_reference:
                    grch37: "/projects/rmorin/reference/igenomes/Homo_sapiens/GSC/GRCh37-lite/Sequence/WholeGenomeFasta/genome.fa"
                    hg38: "/projects/rmorin/reference/igenomes/Homo_sapiens/GSC/GRCh38/Sequence/WholeGenomeFasta/genome.fa"

            igv_presets: ["default", "paired_reads"]

            generate_batch_script:
                padding: 100 # Base pairs upstream and downstream of variant position
                max_height: 1000
                sleep_timer: 2000 # Batch scripts with more options may require longer sleep intervals
                # Available igv options: https://github.com/igvteam/igv/wiki/Batch-commands
                igv_options: 
                    default: ["preference SAM.COLOR_BY READ_STRAND", "preference SAM.SHOW_CENTER_LINE TRUE", "preference SAM.SHADE_BASE_QUALITY true", "preference SAM.DOWNSAMPLE_READS FALSE", "preference SAM.ALLELE_THRESHOLD 0.05", "sort"]
                    paired_reads: ["viewaspairs", "preference SAM.COLOR_BY READ_STRAND", "preference SAM.SHOW_CENTER_LINE TRUE", "preference SAM.SHADE_BASE_QUALITY true", "preference SAM.DOWNSAMPLE_READS FALSE", "preference SAM.ALLELE_THRESHOLD 0.05", "sort QUALITY"]
                view_as_pairs: False # Toggle pairwise orientation in IGV

            xvfb_parameters:
                server_number: "99"
                server_args: ""

            quality_control:
                tumour_only:
                    truncated: ["506","545","547","559",570"]
                    blank:
                        "547":
                            kurtosis: 18.5
                            skewness: -4
                        "559":
                            kurtosis: 18.2
                            skewness: -4
                    failed: ["506"]
                tumour_normal_pair:
                    truncated: ["533","1226","1055"]
                    blank:
                        "<1000":
                            kurtosis: 8
                            skewness: -3
                    failed: ["533"]

        scripts:
            format_regions: "etc/format_regions.py"
            filter_script: "etc/filter_maf.py"
            region_liftover_script: "{MODSDIR}/etc/liftover_regions.sh"
            batch_script_per_variant: "etc/generate_batch_script_per_variant.py"
            batch_script: "etc/generate_batch_scripts.py"
            quality_control: "etc/quality_control.py"

        scratch_subdirectories: []

        conda_envs:
            liftover_regions: "{MODSDIR}/envs/crossmap.yaml"
            wget: "{REPODIR}/envs/wget/wget-1.20.1.yaml"

        threads:
            _igv_symlink_bam: 30
            _igv_symlink_bai: 30
            _igv_quality_control: 20
            _igv_symlink_snapshot: 20

        resources:
            _igv_liftover_regions:
                mem_mb: 2000
            _igv_run:
                mem_mb: 2500
            _igv_quality_control:
                mem_mb: 2500
            
        pairing_config:
            genome:
                run_paired_tumours: True
                run_unpaired_tumours_with: "unmatched_normal"
                run_paired_tumours_as_unpaired: False
            capture:
                run_paired_tumours: True
                run_unpaired_tumours_with: "unmatched_normal"
                run_paired_tumours_as_unpaired: False
